====================================================================
阿里云函数部署说明 - 手动部署步骤
====================================================================

由于 Serverless Devs CLI 在某些 Windows 环境下存在路径识别问题，
请按照以下步骤手动部署每个函数。

--------------------------------------------------------------------
方法 1: 使用 PowerShell（推荐）
--------------------------------------------------------------------

1. 打开 PowerShell（以管理员身份运行）
2. 执行以下命令：

cd C:\Users\13577\Desktop\数据分析系统\aliyun-fc
.\deploy-all.ps1

如果出现权限错误，先执行：
Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass

然后再运行：
.\deploy-all.ps1

--------------------------------------------------------------------
方法 2: 手动逐个部署（最可靠）
--------------------------------------------------------------------

1. 打开 PowerShell 或命令提示符
2. 进入 aliyun-fc 目录：

cd C:\Users\13577\Desktop\数据分析系统\aliyun-fc

3. 逐个部署函数（复制粘贴每条命令，按回车执行）：

s deploy login -t s.yml -y
s deploy stats -t s.yml -y
s deploy chart-data -t s.yml -y
s deploy records -t s.yml -y
s deploy import -t s.yml -y

每个命令执行后，等待完成再执行下一个。

--------------------------------------------------------------------
方法 3: 使用阿里云控制台（如果命令行不工作）
--------------------------------------------------------------------

1. 登录阿里云控制台：https://fc.console.aliyun.com/

2. 进入函数计算服务，选择 cn-hangzhou 区域

3. 对于每个函数（login, stats, chart-data, records, import）：
   a. 找到对应的函数
   b. 点击"代码"标签
   c. 选择"上传代码" -> "上传文件夹"
   d. 选择 C:\Users\13577\Desktop\数据分析系统\aliyun-fc
   e. 上传并部署

--------------------------------------------------------------------
验证部署是否成功
--------------------------------------------------------------------

部署完成后，测试 records 函数：

curl -X OPTIONS "https://records-bsjjdmpsel.cn-hangzhou.fcapp.run"

应该返回 HTTP 200，且响应体为空（或很小）。

如果成功，打开测试页面：
C:\Users\13577\Desktop\数据分析系统\cors-test.html

点击"运行所有测试"，所有测试应该通过。

--------------------------------------------------------------------
常见错误及解决方法
--------------------------------------------------------------------

错误 1: "s.YML file should be yaml or yml file"
解决: 使用 -t s.yml 参数明确指定配置文件

错误 2: "command not found: s"
解决: 重新安装 Serverless Devs CLI
npm install -g @serverless-devs/s

错误 3: PowerShell 执行策略错误
解决: Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass

错误 4: 访问密钥错误
解决: 重新配置密钥
s config add

--------------------------------------------------------------------
需要帮助？
--------------------------------------------------------------------

如果以上方法都无法工作，请：
1. 截图错误信息
2. 检查 C:\Users\13577\.s\logs\ 目录下最新的日志文件
3. 提供错误日志内容

====================================================================
